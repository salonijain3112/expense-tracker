(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{16516:(e,t,r)=>{"use strict";r.d(t,{CurrencyProvider:()=>o,H:()=>l});var a=r(95155),s=r(12115);let n=(0,s.createContext)(void 0),o=e=>{let{children:t}=e,[r,o]=(0,s.useState)("INR");return(0,a.jsx)(n.Provider,{value:{currency:r,setCurrency:o},children:t})},l=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},32383:()=>{},38987:(e,t,r)=>{"use strict";r.d(t,{TransactionProvider:()=>i,x:()=>c});var a=r(95155),s=r(12115),n=r(96648),o=r(54901);let l=(0,s.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)([]),[c,d]=(0,s.useState)(!0),{user:u}=(0,o.A)(),m=(0,s.useCallback)(async()=>{if(u){d(!0);try{let{data:e,error:t}=await n.N.from("transactions").select("id, account_id, description, amount, type, date, to_account_id").eq("user_id",u.id);if(t)throw t;let r=e.map(e=>({id:e.id,accountId:e.account_id,description:e.description,amount:e.amount,type:e.type,date:e.date||void 0,toAccountId:e.to_account_id}));i(r)}catch(e){console.error("Error fetching transactions:",e)}finally{d(!1)}}},[u]);(0,s.useEffect)(()=>{m()},[m]);let x=async e=>{if(u)if("transfer"===e.type&&e.toAccountId){let t={...e,type:"expense",user_id:u.id,account_id:e.accountId,to_account_id:e.toAccountId},r={...e,type:"income",user_id:u.id,account_id:e.toAccountId,to_account_id:e.accountId},{data:a,error:s}=await n.N.from("transactions").insert([t,r]).select();if(s)return void console.error("Error adding transfer transaction:",s);a&&await m()}else{let{data:t,error:r}=await n.N.from("transactions").insert([{...e,user_id:u.id,account_id:e.accountId}]).select().single();if(r)return void console.error("Error adding transaction:",r);t&&await m()}},h=async e=>{if(!u)return;let t=e.map(e=>({user_id:u.id,account_id:e.accountId,description:e.description,amount:e.amount,type:e.type,date:e.date,to_account_id:e.toAccountId}));try{let{error:e}=await n.N.from("transactions").insert(t);if(e)throw console.error("Error bulk adding transactions:",e),e;await m()}catch(e){throw console.error("Network error during bulk transaction insert:",e),e}};return(0,a.jsx)(l.Provider,{value:{transactions:r,addTransaction:x,bulkAddTransactions:h,isLoading:c},children:t})},c=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useTransactions must be used within a TransactionProvider");return e}},50231:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>O});var a=r(95155),s=r(12115),n=r(54901),o=r(15239);let l=()=>{var e;let{user:t,signOut:r}=(0,n.A)(),[l,i]=(0,s.useState)(!1),c=(0,s.useRef)(null);if((0,s.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),!t)return null;let d=null==(e=t.user_metadata)?void 0:e.avatar_url,u=t.email||"";return(0,a.jsxs)("div",{className:"relative",ref:c,children:[(0,a.jsx)("button",{onClick:()=>i(!l),className:"w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent",children:d?(0,a.jsx)(o.default,{src:d,alt:"User Avatar",width:40,height:40,className:"rounded-full"}):(0,a.jsx)("span",{className:"text-lg font-semibold",children:(e=>e?e.charAt(0).toUpperCase():"?")(u)})}),l&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-dark-secondary rounded-md shadow-lg py-1 z-50 ring-1 ring-black ring-opacity-5",children:[(0,a.jsxs)("div",{className:"px-4 py-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-700 dark:text-dark-text",children:"Signed in as"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:u})]}),(0,a.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-600"}),(0,a.jsx)("button",{onClick:r,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-dark-text hover:bg-gray-100 dark:hover:bg-dark-hover",children:"Logout"})]})]})},i=()=>(0,a.jsx)("header",{className:"bg-emerald-500 text-white shadow-lg rounded-b-3xl",children:(0,a.jsxs)("div",{className:"px-4 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{className:"p-2",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"Home"})]}),(0,a.jsx)(l,{})]}),(0,a.jsxs)("div",{className:"flex space-x-8",children:[(0,a.jsx)("button",{className:"text-white font-medium pb-2 border-b-2 border-white",children:"ACCOUNTS"}),(0,a.jsx)("button",{className:"text-white/70 font-medium pb-2",children:"WALLET NOW"})]})]})});var c=r(16516),d=r(77296);let u=e=>{let{transactions:t}=e,{currency:r}=(0,c.H)(),{selectedAccounts:s}=(0,d.o)(),n="INR"===r?"₹":"$",o=t.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),l=t.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),i=s.reduce((e,t)=>e+t.opening_balance,0)+o-l;return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Financial Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-dark-subtle",children:"Total Income"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-income",children:[n,o.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-dark-subtle",children:"Total Expenses"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-expense",children:[n,l.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-dark-subtle",children:"Net Balance"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-dark-text",children:[n,i.toFixed(2)]})]})]})]})},m=e=>{let{transactions:t}=e,{currency:r}=(0,c.H)(),{accounts:s}=(0,d.o)(),n="INR"===r?"₹":"$",o=new Map(s.map(e=>[e.id,e]));return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Recent Transactions"}),0===t.length?(0,a.jsx)("p",{className:"text-gray-500 dark:text-dark-subtle",children:"No transactions for selected accounts."}):(0,a.jsx)("ul",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:t.map(e=>{let r=o.get(e.accountId),s=e.description;if(e.description.startsWith("Transfer to")){let t=o.get(e.toAccountId||"");t&&(s="Transfer to ".concat(t.name))}else if(e.description.startsWith("Transfer from")){let r=t.find(t=>t.id===e.id.replace("-to",""));if(r){let e=o.get(r.accountId);e&&(s="Transfer from ".concat(e.name))}}return(0,a.jsxs)("li",{className:"py-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[r&&(0,a.jsx)("span",{className:"w-2 h-10 rounded-full flex-shrink-0",style:{backgroundColor:r.color},title:r.name}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 dark:text-dark-text",children:s}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:[(0,a.jsx)("span",{className:"font-semibold",children:null==r?void 0:r.name}),e.date?" | ".concat(new Date(e.date).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})):""]})]})]}),(0,a.jsxs)("span",{className:"font-semibold text-lg whitespace-nowrap ".concat("income"===e.type?"text-income":"text-expense"),children:["income"===e.type?"+":"-",n,e.amount.toFixed(2)]})]},e.id)})})]})};var x=r(70740);r(99157);var h=r(43569),g=r(96059),f=r(57218);let p=e=>{let{options:t,value:r,onChange:n,onCreateOption:o,placeholder:l="Select an option...",disabled:i=!1,loading:c=!1,clearable:d=!1,className:u="",id:m}=e,[x,p]=(0,s.useState)(!1),[b,y]=(0,s.useState)(""),[v,k]=(0,s.useState)(-1),j=(0,s.useRef)(null),N=(0,s.useRef)(null),w=t.filter(e=>e.label.toLowerCase().includes(b.toLowerCase())),C=o&&b.trim()&&!w.some(e=>e.label.toLowerCase()===b.toLowerCase());(0,s.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&(p(!1),y(""),k(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.useEffect)(()=>{let e=e=>{if(!x)return;let t=w.length+ +!!C;switch(e.key){case"ArrowDown":e.preventDefault(),k(e=>e<t-1?e+1:0);break;case"ArrowUp":e.preventDefault(),k(e=>e>0?e-1:t-1);break;case"Enter":e.preventDefault(),v>=0&&(v<w.length?S(w[v]):C&&A());break;case"Escape":p(!1),y(""),k(-1)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[x,v,w,C,b]);let S=e=>{n(e),p(!1),y(""),k(-1)},A=async()=>{if(o&&b.trim())try{let e=await o(b.trim());e&&n(e),p(!1),y(""),k(-1)}catch(e){console.error("Failed to create option:",e)}};return(0,a.jsxs)("div",{ref:j,className:"relative ".concat(u),children:[(0,a.jsx)("div",{className:"\n          w-full px-3 py-2 bg-brand-secondary dark:bg-dark-card \n          border border-gray-300 dark:border-gray-700 rounded-lg \n          shadow-sm cursor-pointer transition-colors\n          ".concat(x?"ring-2 ring-brand-accent border-brand-accent":"hover:border-brand-accent","\n          ").concat(i?"opacity-50 cursor-not-allowed":"","\n        "),onClick:()=>{i||c||(p(!x),x||setTimeout(()=>{var e;return null==(e=N.current)?void 0:e.focus()},0))},children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex-1 min-w-0",children:x?(0,a.jsx)("input",{ref:N,type:"text",value:b,onChange:e=>y(e.target.value),className:"w-full bg-transparent outline-none text-gray-900 dark:text-dark-text placeholder-gray-500 dark:placeholder-gray-400",placeholder:r?r.label:l,onClick:e=>e.stopPropagation(),id:m}):(0,a.jsx)("span",{className:"block truncate ".concat(r?"text-gray-900 dark:text-dark-text":"text-gray-500 dark:text-gray-400"),children:r?r.label:l})}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[d&&r&&!i&&(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),n(null)},className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:(0,a.jsx)(h.A,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})}),(0,a.jsx)(g.A,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 transition-transform ".concat(x?"rotate-180":"")})]})]})}),x&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-dark-card border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg max-h-60 overflow-auto",children:c?(0,a.jsx)("div",{className:"px-3 py-2 text-gray-500 dark:text-gray-400",children:"Loading..."}):(0,a.jsx)(a.Fragment,{children:0!==w.length||C?(0,a.jsxs)(a.Fragment,{children:[w.map((e,t)=>(0,a.jsx)("div",{className:"\n                        px-3 py-2 cursor-pointer transition-colors\n                        ".concat(v===t?"bg-brand-accent text-white":"text-gray-900 dark:text-dark-text hover:bg-gray-100 dark:hover:bg-gray-700","\n                      "),onClick:()=>S(e),children:e.label},e.value)),C&&(0,a.jsxs)("div",{className:"\n                        px-3 py-2 cursor-pointer transition-colors flex items-center space-x-2\n                        ".concat(v===w.length?"bg-brand-accent text-white":"text-brand-accent hover:bg-gray-100 dark:hover:bg-gray-700","\n                      "),onClick:A,children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:['Create "',b,'"']})]})]}):(0,a.jsx)("div",{className:"px-3 py-2 text-gray-500 dark:text-gray-400",children:"No options found"})})})]})},b=e=>{let{onAddTransaction:t}=e,{accounts:r,selectedAccounts:n,addAccount:o}=(0,d.o)(),[l,i]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[m,h]=(0,s.useState)("expense"),[g,f]=(0,s.useState)(new Date),[b,y]=(0,s.useState)(null),[v,k]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[w,C]=(0,s.useState)(!1),S=r.map(e=>({value:e.id,label:e.name}));(0,s.useEffect)(()=>{1===n.length?y({value:n[0].id,label:n[0].name}):y(null),k(null)},[n,r]);let A=async e=>{C(!0);let t=await o({name:e,color:"#CCCCCC",opening_balance:0});return(C(!1),t)?{value:t.id,label:t.name}:null},I=async e=>{e.preventDefault();let r=parseFloat(c);if(!l||!c||isNaN(r)||r<=0||!b)return void alert("Please fill all fields, including selecting or creating an account.");if("transfer"===m&&!v)return void alert("Please select or create a destination account for the transfer.");if("transfer"===m&&(null==b?void 0:b.value)===(null==v?void 0:v.value))return void alert("From and To accounts cannot be the same for a transfer.");N(!0);try{await t({accountId:b.value,description:l,amount:r,type:m,date:(g||new Date).toISOString(),..."transfer"===m&&{toAccountId:null==v?void 0:v.value}}),i(""),u(""),h("expense"),f(new Date),1!==n.length&&y(null),k(null)}catch(e){console.error("Failed to add transaction",e),alert("Failed to add transaction. Please try again.")}finally{N(!1)}};return(0,a.jsx)("div",{className:"p-4 bg-white dark:bg-dark-bg shadow-md rounded-lg",children:(0,a.jsx)("form",{onSubmit:I,className:"space-y-6",children:(0,a.jsxs)("fieldset",{disabled:j,className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-dark-text",children:"Add Transaction"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Account"}),(0,a.jsx)(p,{id:"account",options:S,value:b,onChange:y,onCreateOption:A,placeholder:"Select or create an account...",disabled:w||1===n.length&&!!b,loading:w,clearable:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Description"}),(0,a.jsx)("input",{type:"text",id:"description",value:l,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 bg-brand-secondary dark:bg-dark-bg border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-brand-accent text-gray-900 dark:text-dark-text disabled:opacity-50",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Amount"}),(0,a.jsx)("input",{type:"number",id:"amount",value:c,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 bg-brand-secondary dark:bg-dark-bg border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-brand-accent text-gray-900 dark:text-dark-text disabled:opacity-50",required:!0,step:"0.01"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Type"}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:["expense","income","transfer"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>h(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 ".concat(m===e?"bg-brand-accent text-white":"bg-brand-secondary dark:bg-dark-hover text-gray-700 dark:text-dark-text hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),"transfer"===m&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"To Account"}),(0,a.jsx)(p,{id:"toAccount",options:S.filter(e=>e.value!==(null==b?void 0:b.value)),value:v,onChange:k,onCreateOption:A,placeholder:"Select or create destination...",disabled:w,loading:w,clearable:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Date"}),(0,a.jsx)(x.Ay,{id:"date",selected:g,onChange:e=>f(e),className:"w-full px-3 py-2 bg-brand-secondary dark:bg-dark-bg border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-brand-accent text-gray-900 dark:text-dark-text disabled:opacity-50"})]}),(0,a.jsx)("div",{className:"flex justify-end pt-2",children:(0,a.jsx)("button",{type:"submit",className:"w-full px-4 py-2 bg-brand-accent text-white font-semibold rounded-lg shadow-md hover:bg-brand-accent-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent disabled:opacity-50 transition-colors",children:j?"Adding...":"Add Transaction"})})]})})})};var y=r(9349),v=r.n(y),k=r(4246);function j(e){if(null==e||e instanceof Date)return null;let t="number"==typeof e?e:parseFloat(String(e).replace(/[,\s]/g,""));return Number.isNaN(t)?null:t}function N(e){if(!e)return;if(e instanceof Date)return e;let t=String(e).trim(),r=t.match(/^(\d{4}-\d{2}-\d{2})\s(\d{2}:\d{2}:\d{2})$/);if(r){let e=new Date("".concat(r[1],"T").concat(r[2]));if(!isNaN(e.getTime()))return e}let a=new Date(t);if(!isNaN(a.getTime()))return a}function w(e,t){let r=(String(e||"")||"").toLowerCase().replace(/\s+/g,"");return"income"===r?"income":"expenses"===r||"expense"===r?"expense":null!=t?t>=0?"income":"expense":null}let C=e=>{let{transactions:t,onImport:r}=e,n=(0,s.useRef)(null),{accounts:o,selectedAccounts:l,addAccount:i}=(0,d.o)(),c=async e=>{try{var t;let a=function(e){if(!e||0===e.length)return[];let t=Array.from(new Set(Object.keys(e[0]||{}).map(e=>e.trim()))),r=new Map(t.map(e=>[e.toLowerCase(),e])),a=(e,t)=>e[r.get(t.toLowerCase())||t],s="generic";!function(e){let t=new Set(e.map(e=>e.toLowerCase()));return["account","category","currency","amount","type","note","date"].every(e=>t.has(e))}(t)?function(e){let t=new Set(e.map(e=>e.toLowerCase()));return t.has("description")&&t.has("amount")}(t)&&(s="generic"):s="report";let n=[];for(let t of e){var o,l,i,c;if(t)if("report"===s){let e=j(a(t,"amount")),r=w(a(t,"type"),e),s=String(null!=(o=a(t,"note"))?o:"").trim(),i=N(a(t,"date")),c=String(null!=(l=a(t,"account"))?l:"").trim();if(!s&&null==e||null==e||null==r)continue;n.push({tx:{accountId:"",description:s||"Transaction",amount:Math.abs(e),type:r,date:i?i.toISOString():void 0},accountName:c||void 0})}else{let e=String(null!=(i=a(t,"description"))?i:"").trim(),r=j(a(t,"amount")),s=w(a(t,"type"),r),o=N(a(t,"date")),l=String(null!=(c=a(t,"account"))?c:"").trim();if(!e&&null==r||null==r||null==s)continue;n.push({tx:{accountId:"",description:e,amount:Math.abs(r),type:s,date:o?o.toISOString():void 0},accountName:l||void 0})}}return n}(e),s=new Map(o.map(e=>[e.name.trim().toLowerCase(),e.id])),n=o.length>0?1===l.length?l[0].id:(null==(t=o[0])?void 0:t.id)||"":"",c=new Set;a.forEach(e=>{let{accountName:t}=e;t&&""!==t.trim()&&c.add(t.trim())});let d=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4"],u=0;for(let e of c){let t=e.toLowerCase();if(!s.get(t)){let r=d[u%d.length];u+=1;try{let a=await i({name:e,color:r,opening_balance:0});a?(s.set(t,a.id),console.log('Created new account: "'.concat(e,'" with ID: ').concat(a.id))):console.warn('Failed to create account "'.concat(e,'", will use default account'))}catch(t){console.error('Failed to create account "'.concat(e,'":'),t)}}}let m=a.map(e=>{let{tx:t,accountName:r}=e,a="";if(r&&""!==r.trim()){let e=r.trim().toLowerCase();a=s.get(e)||n}else o.length>0&&(a=n);return!a&&n&&(a=n),{...t,accountId:a||"",id:crypto.randomUUID()}});if(0===m.length)return!1;return r(m),!0}catch(e){return console.error("Normalization failed:",e),!1}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-dark-text",children:"Data Management"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-2",children:"Import Transactions"}),(0,a.jsxs)("button",{onClick:()=>{var e;return null==(e=n.current)?void 0:e.click()},className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-dashed border-gray-400 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-500 dark:text-dark-subtle hover:bg-gray-100 dark:hover:bg-dark-card focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent dark:focus:ring-offset-dark-bg transition-all",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4 4m0 0L8 8m4-4v12"})}),(0,a.jsx)("span",{children:"Click to upload a file"})]}),(0,a.jsx)("input",{type:"file",ref:n,onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(!r)return;let a=new FileReader;r.name.endsWith(".csv")?v().parse(r,{header:!0,skipEmptyLines:!0,complete:async e=>{if(!await c(e.data)){var t;console.debug("[Import][CSV] Headers:",null==(t=e.meta)?void 0:t.fields),alert("No valid transactions found in the CSV. Please check the headers and data.")}},error:e=>{console.error("Error parsing CSV:",e),alert("Failed to parse CSV file. Please check the format.")}}):r.name.endsWith(".xlsx")||r.name.endsWith(".xls")?(a.onload=async e=>{try{var t;let r=null==(t=e.target)?void 0:t.result,a=k.LF(r,{type:"array"}),s=a.SheetNames[0],n=a.Sheets[s],o=k.Wp.sheet_to_json(n,{header:1,raw:!1});if(console.debug("[Import] Rows(header=1) len=",o.length,"firstHeaderRow=",o[0]),o.length>=2){let e=o[0].map(e=>String(e||"").trim().toLowerCase()),t=o.slice(1).filter(e=>Array.isArray(e)).map(t=>{let r={};return e.forEach((e,a)=>{r[e]=t[a]}),r});console.debug("[Import] Objects len=",t.length,"sample=",t[0]),await c(t)||alert("No valid transactions found in the Excel file. Please check the headers and data.")}else throw Error("No data rows found in sheet")}catch(e){console.error("Error processing Excel file:",e),alert("Failed to process Excel file.")}},a.onerror=e=>{console.error("Error reading Excel file:",e),alert("Failed to read Excel file.")},a.readAsArrayBuffer(r)):alert("Unsupported file type. Please upload a CSV or Excel file."),n.current&&(n.current.value="")},className:"hidden",accept:".csv, .xlsx, .xls"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-dark-subtle mt-2",children:"Supported formats: CSV, XLSX, XLS."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-2",children:"Export Transactions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([v().unparse(t)],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),a=URL.createObjectURL(e);r.setAttribute("href",a),r.setAttribute("download","transactions.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},disabled:0===t.length,className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-900 dark:text-dark-text bg-brand-secondary dark:bg-dark-bg hover:bg-gray-200 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent dark:focus:ring-offset-dark-card disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0L8 8m4-4v12"})}),(0,a.jsx)("span",{children:"Export CSV"})]}),(0,a.jsxs)("button",{onClick:()=>{let e=k.Wp.json_to_sheet(t),r=k.Wp.book_new();k.Wp.book_append_sheet(r,e,"Transactions"),k._h(r,"transactions.xlsx")},disabled:0===t.length,className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-900 dark:text-dark-text bg-brand-secondary dark:bg-dark-bg hover:bg-gray-200 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent dark:focus:ring-offset-dark-card disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0L8 8m4-4v12"})}),(0,a.jsx)("span",{children:"Export Excel"})]})]})]})]})};var S=r(72999);let A=e=>{let{onClose:t}=e,{addAccount:r}=(0,d.o)(),[n,o]=(0,s.useState)(""),[l,i]=(0,s.useState)("0"),[c,u]=(0,s.useState)("#FF5733"),[m,x]=(0,s.useState)(!1),h=async e=>{if(e.preventDefault(),!m){x(!0);try{await r({name:n,opening_balance:parseFloat(l)||0,color:c}),t()}catch(e){console.error("Failed to add account",e)}finally{x(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-sm z-50 dark:bg-dark-secondary",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 dark:text-white",children:"Add New Account"}),(0,a.jsx)("form",{onSubmit:h,children:(0,a.jsxs)("fieldset",{disabled:m,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Account Name"}),(0,a.jsx)("input",{type:"text",id:"name",value:n,onChange:e=>o(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-dark-hover dark:border-gray-600 dark:placeholder-gray-400 dark:text-white disabled:opacity-50",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"opening_balance",className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Opening Balance"}),(0,a.jsx)("input",{type:"number",id:"opening_balance",value:l,onChange:e=>i(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-dark-hover dark:border-gray-600 dark:placeholder-gray-400 dark:text-white disabled:opacity-50",placeholder:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text mb-2",children:"Account Color"}),(0,a.jsx)(S.z0,{color:c,onChangeComplete:e=>{u(e.hex)}})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 dark:bg-dark-hover dark:text-dark-text disabled:opacity-50",disabled:m,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:m,children:m?"Adding...":"Add Account"})]})]})})]})})},I=()=>{let{accounts:e,selectedAccounts:t,setSelectedAccountIds:r}=(0,d.o)(),[n,o]=(0,s.useState)(!1),l=e.length>0&&t.length===e.length;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center flex-wrap gap-2 p-4 bg-gray-100 dark:bg-dark-secondary rounded-lg",children:e.map(e=>{let s=t.some(t=>t.id===e.id);return(0,a.jsx)("button",{onClick:()=>{r([e.id])},className:"cursor-pointer px-4 py-2 rounded-md text-sm font-medium border-2 transition-colors duration-200 ease-in-out                 focus:ring-2 focus:ring-offset-2 focus:ring-primary-focus                 ".concat(s?"text-white":"text-gray-700 dark:text-dark-text hover:bg-gray-200 dark:hover:bg-dark-hover"),style:{backgroundColor:s?e.color:"transparent",borderColor:e.color},children:e.name},e.id)})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2 px-4",children:[(0,a.jsx)("button",{onClick:()=>{r(e.map(e=>e.id))},disabled:l,className:"text-sm font-medium text-indigo-600 hover:text-indigo-500 disabled:text-gray-400 disabled:cursor-not-allowed underline transition-colors",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>o(!0),className:"px-4 py-2 rounded-md text-sm font-medium bg-indigo-600 text-white hover:bg-indigo-700 transition-colors",children:"+ Add Account"})]}),n&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",role:"dialog","aria-modal":"true",children:(0,a.jsx)("div",{className:"bg-white dark:bg-dark-secondary p-6 rounded-lg shadow-xl w-full max-w-md",children:(0,a.jsx)(A,{onClose:()=>o(!1)})})})]})};var E=r(96648);let L=e=>{let{onSuccess:t}=e,[r,n]=(0,s.useState)(!1),[o,l]=(0,s.useState)(""),[i,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(""),[m,x]=(0,s.useState)(!1),[h,g]=(0,s.useState)(""),f=async e=>{e.preventDefault(),x(!0),g("");try{if(r){if(i!==d)return void g("Passwords do not match");let{error:e}=await E.N.auth.signUp({email:o,password:i});if(e)throw e;g("Check your email for the confirmation link!")}else{let{error:e}=await E.N.auth.signInWithPassword({email:o,password:i});if(e)throw e;null==t||t()}}catch(e){g(e instanceof Error?e.message:"An unexpected error occurred")}finally{x(!1)}},p=async()=>{x(!0),g("");try{let{error:e}=await E.N.auth.signInWithOAuth({provider:"google",options:{queryParams:{prompt:"select_account"}}});if(e)throw e}catch(e){g(e instanceof Error?e.message:"An unexpected error occurred")}finally{x(!1)}},b=async e=>{l(e),e.includes("@")&&e.includes(".com")?g(""):g("Please enter valid email")};return(0,a.jsxs)("div",{className:"w-full max-w-md space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Expense Tracker"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:r?"Create your account":"Sign in to your account"})]}),h&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:h}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email address"}),(0,a.jsx)("input",{id:"email",type:"email",required:!0,value:o,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter your email"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",required:!0,value:i,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter your password"})]}),r&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,a.jsx)("input",{id:"confirmPassword",type:"password",required:!0,value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Confirm your password"})]}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Loading...":r?"Sign up":"Sign in"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,a.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,a.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,a.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),(0,a.jsxs)("button",{onClick:p,disabled:m,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsxs)("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>n(!r),className:"text-sm text-emerald-600 hover:text-emerald-500 font-medium",children:r?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})},_=e=>{let{children:t}=e,{session:r,isLoading:s}=(0,n.A)();return s?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):r?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gray-100 px-4 py-8",children:(0,a.jsx)("div",{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow-lg",children:(0,a.jsx)(L,{})})})},F=e=>{let{activeTab:t,onTabChange:r}=e,s=[{key:"dashboard",label:"Dashboard",icon:(0,a.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{key:"reports",label:"Reports",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{key:"actions",label:"Actions",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}];return(0,a.jsx)("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-dark-card border-t border-gray-200 dark:border-gray-800 z-50",children:(0,a.jsx)("div",{className:"flex justify-around items-center h-16 px-4",children:s.map(e=>(0,a.jsxs)("button",{onClick:()=>r(e.key),className:"flex flex-col items-center justify-center space-y-1 px-3 py-2 rounded-lg transition-colors duration-200 ".concat(t===e.key?"text-brand-accent bg-brand-accent/10":"text-gray-500 dark:text-dark-subtle hover:text-gray-700 dark:hover:text-dark-text"),"aria-label":e.label,children:[e.icon,(0,a.jsx)("span",{className:"text-xs font-medium",children:e.label})]},e.key))})})},T=e=>{var t,r,n;let{transactions:o}=e,{accounts:l}=(0,d.o)(),{currency:i}=(0,c.H)(),[u,m]=(0,s.useState)("all"),x="INR"===i?"₹":"$",h=new Map(l.map(e=>[e.id,e])),g=(0,s.useMemo)(()=>"all"===u?o:o.filter(e=>e.accountId===u),[o,u]),f=(0,s.useMemo)(()=>{let e=g.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),t=g.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0);return{income:e,expenses:t,balance:e-t}},[g]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Filter by Account"}),(0,a.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-dark-card text-gray-900 dark:text-dark-text focus:ring-2 focus:ring-brand-accent focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Accounts"}),l.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"all"===u?"Overall Summary":"".concat(null==(t=h.get(u))?void 0:t.name," Summary")}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:"Income"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-income",children:["+",x,f.income.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:"Expenses"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-expense",children:["-",x,f.expenses.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:"Balance"}),(0,a.jsxs)("p",{className:"text-lg font-semibold ".concat(f.balance>=0?"text-income":"text-expense"),children:[f.balance>=0?"+":"",x,f.balance.toFixed(2)]})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:["Transactions ","all"!==u&&"- ".concat(null==(r=h.get(u))?void 0:r.name)]}),0===g.length?(0,a.jsx)("p",{className:"text-gray-500 dark:text-dark-subtle",children:"all"===u?"No transactions found.":"No transactions found for ".concat(null==(n=h.get(u))?void 0:n.name,".")}):(0,a.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:g.map(e=>{let t=h.get(e.accountId),r=e.description;if(e.description.startsWith("Transfer to")){let t=h.get(e.toAccountId||"");t&&(r="Transfer to ".concat(t.name))}else if(e.description.startsWith("Transfer from")){let t=g.find(t=>t.id===e.id.replace("-to",""));if(t){let e=h.get(t.accountId);e&&(r="Transfer from ".concat(e.name))}}return(0,a.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-dark-bg rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t&&(0,a.jsx)("span",{className:"w-2 h-8 rounded-full flex-shrink-0",style:{backgroundColor:t.color},title:t.name}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 dark:text-dark-text truncate",children:r}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:["all"===u&&(0,a.jsxs)("span",{className:"font-semibold",children:[null==t?void 0:t.name," | "]}),e.date?new Date(e.date).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""]})]})]}),(0,a.jsxs)("span",{className:"font-semibold text-lg whitespace-nowrap ml-2 ".concat("income"===e.type?"text-income":"text-expense"),children:["income"===e.type?"+":"-",x,e.amount.toFixed(2)]})]},e.id)})})]})]})},D=e=>{let{onAddTransaction:t,transactions:r,onImport:s}=e,{accounts:n}=(0,d.o)();return(0,a.jsxs)("div",{className:"space-y-6",children:[n.length>0&&(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Add Transaction"}),(0,a.jsx)(b,{onAddTransaction:t})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Import/Export"}),(0,a.jsx)(C,{transactions:r,onImport:s})]}),0===n.length&&(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-brand-accent/10 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-brand-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-dark-text mb-2",children:"Create Your First Account"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-dark-subtle mb-4",children:"Start by creating an account to track your transactions. You can add multiple accounts for different purposes."}),(0,a.jsx)("p",{className:"text-sm text-gray-400 dark:text-dark-subtle",children:"Use the account switcher at the top to create and manage your accounts."})]})})]})},M=e=>{let{account:t,balance:r,onClick:s,isSelected:n=!1}=e,{currency:o}=(0,c.H)(),{type:l,color:i}=(e=>{let t=e.toLowerCase();if(t.includes("bank")||t.includes("hdfc")||t.includes("sbi")||t.includes("central"))return{type:"BANK",color:"bg-red-500"};if(t.includes("savings")||t.includes("saving"))return{type:"SAVINGS",color:"bg-orange-500"};if(t.includes("paypal")||t.includes("paytm")||t.includes("phone pe"))return{type:"PAYPAL",color:"bg-blue-500"};if(t.includes("investment")||t.includes("mutual")||t.includes("zerodha"))return{type:"INVESTMENTS",color:"bg-teal-500"};if(t.includes("cash"))return{type:"CASH",color:"bg-green-500"};else if(t.includes("credit")||t.includes("card"))return{type:"CREDIT CARD",color:"bg-gray-600"};else if(t.includes("amazon"))return{type:"AMAZON",color:"bg-yellow-600"};else return{type:"OTHER",color:"bg-purple-500"}})(t.name);return(0,a.jsx)("div",{onClick:s,className:"".concat(i," text-white p-4 rounded-2xl shadow-lg cursor-pointer transition-all duration-200 hover:scale-105 ").concat(n?"ring-2 ring-white ring-opacity-50":""),children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"text-xs font-medium opacity-90 mb-1",children:l}),(0,a.jsxs)("div",{className:"text-lg font-bold",children:["INR"===o?"₹":"$"," ",r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,a.jsx)("div",{className:"text-xs opacity-75 mt-1 truncate",children:t.name})]})})},P=e=>{let{transactions:t,onAccountSelect:r,selectedAccountIds:n=[],onAddTransaction:o}=e,{accounts:l}=(0,d.o)(),{currency:i}=(0,c.H)(),u="INR"===i?"₹":"$",m=(0,s.useMemo)(()=>{let e=new Map;return l.forEach(t=>{e.set(t.id,t.opening_balance||0)}),t.forEach(t=>{let r=e.get(t.accountId)||0;"income"===t.type?e.set(t.accountId,r+t.amount):e.set(t.accountId,r-t.amount)}),e},[l,t]),x=(0,s.useMemo)(()=>{let e=new Date;e.setDate(e.getDate()-30);let r=t.filter(t=>"expense"===t.type&&t.date&&new Date(t.date)>=e),a=r.reduce((e,t)=>e+t.amount,0),s=new Map;return r.forEach(e=>{let t=e.description.split(" ")[0]||"Other";s.set(t,(s.get(t)||0)+e.amount)}),{total:a,categories:Array.from(s.entries()).map(e=>{let[t,r]=e;return{name:t,amount:r,percentage:a>0?r/a*100:0}})}},[t]),h=["#10b981","#ef4444","#f59e0b","#3b82f6","#8b5cf6"];return(0,a.jsxs)("div",{className:"space-y-6 pb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"List of accounts"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:l.map((e,t)=>(0,a.jsx)(M,{account:e,balance:m.get(e.id)||0,onClick:()=>null==r?void 0:r(e.id),isSelected:n.includes(e.id)},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Expense structure"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"LAST 30 DAYS"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900 mb-6",children:[u," ",x.total.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),x.total>0?(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)("div",{className:"relative w-48 h-48",children:[(0,a.jsxs)("svg",{className:"w-48 h-48 transform -rotate-90",viewBox:"0 0 42 42",children:[(0,a.jsx)("circle",{cx:"21",cy:"21",r:"15.915",fill:"transparent",stroke:"#e5e7eb",strokeWidth:"3"}),x.categories.map((e,t)=>{let r=h[t%h.length],s=2*Math.PI*15.915,n=s-e.percentage/100*s,o=x.categories.slice(0,t).reduce((e,t)=>e+t.percentage,0);return(0,a.jsx)("circle",{cx:"21",cy:"21",r:"15.915",fill:"transparent",stroke:r,strokeWidth:"3",strokeDasharray:s,strokeDashoffset:n,strokeLinecap:"round",style:{transformOrigin:"21px 21px",transform:"rotate(".concat(o/100*360,"deg)")},className:"transition-all duration-300"},e.name)})]}),(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"All"}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:[u," ",x.total.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-48",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No expenses in the last 30 days"})]})}),x.categories.length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:x.categories.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:h[t%h.length]}}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.name})]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[u,e.amount.toFixed(2)," (",e.percentage.toFixed(1),"%)"]})]},e.name))})]}),(0,a.jsx)("div",{className:"fixed bottom-20 right-4 z-40",children:(0,a.jsx)("button",{onClick:o,className:"bg-blue-500 hover:bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-110",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]})};var W=r(38987);function O(){let{accounts:e,selectedAccounts:t,setSelectedAccountIds:r}=(0,d.o)(),{transactions:n,addTransaction:o,bulkAddTransactions:l}=(0,W.x)(),[c,x]=(0,s.useState)("dashboard"),h=async e=>{await o(e)},g=async e=>{try{let t=e.filter(e=>!e.accountId||""===e.accountId.trim());if(t.length>0){console.error("Some transactions have invalid account IDs:",t),alert("Some transactions could not be imported due to invalid account information.");return}let r=e.map(e=>{let{id:t,...r}=e;return r});await l(r),alert("Transactions imported successfully!")}catch(r){console.error("Import failed:",r);let e=r instanceof Error?r.message:"Unknown error occurred",t=r&&"object"==typeof r&&"code"in r?r.code:void 0;(null==e?void 0:e.includes("Failed to fetch"))||""===t?alert("Import failed due to network connectivity issues. Please check your internet connection and try again."):alert("Import failed: ".concat(e))}},f=(0,s.useMemo)(()=>{if(0===t.length)return[];let e=t.map(e=>e.id);return n.filter(t=>e.includes(t.accountId))},[n,t]),p=a=>{if(!e.find(e=>e.id===a))return;let s=t.some(e=>e.id===a),n=t.map(e=>e.id);s?r(n.filter(e=>e!==a)):r([...n,a])},y=()=>{x("actions")};return(0,a.jsx)(_,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-dark-background text-gray-900 dark:text-dark-text",children:[(0,a.jsx)(i,{}),(0,a.jsx)("main",{className:"px-4 py-6",children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("div",{className:"hidden md:block",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,a.jsx)(u,{transactions:f}),(0,a.jsx)(m,{transactions:f})]}),(0,a.jsxs)("div",{className:"space-y-8",children:[e.length>0&&(0,a.jsx)("div",{className:"card",children:(0,a.jsx)(b,{onAddTransaction:h})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsx)(C,{transactions:f,onImport:g})})]})]})}),(0,a.jsx)("div",{className:"md:hidden pb-20",children:(()=>{switch(c){case"dashboard":return(0,a.jsx)(P,{transactions:n,onAccountSelect:p,selectedAccountIds:t.map(e=>e.id),onAddTransaction:y});case"reports":return(0,a.jsx)(T,{transactions:f});case"actions":return(0,a.jsx)(D,{onAddTransaction:h,transactions:f,onImport:g});default:return null}})()}),(0,a.jsx)("div",{className:"hidden md:block",children:(0,a.jsx)(I,{})})]})}),(0,a.jsx)(F,{activeTab:c,onTabChange:x})]})})}},54901:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>l});var a=r(95155),s=r(12115),n=r(96648);let o=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await n.N.auth.getSession();l(t),c(null!=(e=null==t?void 0:t.user)?e:null),u(!1)})();let{data:e}=n.N.auth.onAuthStateChange((e,t)=>{var r;l(t),c(null!=(r=null==t?void 0:t.user)?r:null),u(!1)});return()=>{null==e||e.subscription.unsubscribe()}},[]);let m=async()=>{await n.N.auth.signOut()};return(0,a.jsx)(o.Provider,{value:{session:r,user:i,isLoading:d,signOut:m},children:t})},i=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},64710:(e,t,r)=>{Promise.resolve().then(r.bind(r,50231))},77296:(e,t,r)=>{"use strict";r.d(t,{AccountProvider:()=>i,o:()=>c});var a=r(95155),s=r(12115),n=r(96648),o=r(54901);let l=(0,s.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),{user:x}=(0,o.A)(),h=(0,s.useCallback)(async()=>{if(x){m(!0);try{let{data:e,error:t}=await n.N.from("accounts").select("id, name, color, opening_balance").eq("user_id",x.id);if(t)throw t;let r=e.map(e=>({id:e.id,name:e.name,color:e.color,opening_balance:e.opening_balance||0}));i(r),r.length>0&&0===c.length&&d([r[0].id])}catch(e){console.error("Error fetching accounts:",e)}finally{m(!1)}}},[x,c.length]);(0,s.useEffect)(()=>{h()},[h]);let g=async e=>{if(!x)return null;try{let{data:r,error:a}=await n.N.from("accounts").select("id, name, color, opening_balance").eq("user_id",x.id).eq("name",e.name.trim()).single();if(a&&"PGRST116"!==a.code){var t;if(console.error("Error checking for existing account:",a),(null==(t=a.message)||!t.includes("Failed to fetch"))&&""!==a.code)return null;console.warn("Network error during duplicate check, proceeding with account creation")}else if(r)return{id:r.id,name:r.name,color:r.color,opening_balance:r.opening_balance||0}}catch(e){console.warn("Network error during account lookup, proceeding with creation:",e)}let{data:r,error:a}=await n.N.from("accounts").insert([{name:e.name,color:e.color,opening_balance:e.opening_balance||0,user_id:x.id}]).select().single();if(a)return console.error("Error adding account:",a),null;if(r){let e={id:r.id,name:r.name,color:r.color,opening_balance:r.opening_balance||0};return i(t=>[...t,e]),d(t=>[...t,e.id]),e}return null},f=r.filter(e=>c.includes(e.id));return(0,a.jsx)(l.Provider,{value:{accounts:r,addAccount:g,selectedAccounts:f,setSelectedAccountIds:d,isLoading:u},children:t})},c=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAccounts must be used within an AccountProvider");return e}},83686:()=>{},96648:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(65040).UU)("https://nromeycartzmsproexuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yb21leWNhcnR6bXNwcm9leHVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NjA2ODMsImV4cCI6MjA3NDAzNjY4M30.cITyMLIOAmlkqXZIocWLHpKrO1BqbtwoHEqYcktRPUg")}},e=>{e.O(0,[38,524,20,579,40,182,441,255,358],()=>e(e.s=64710)),_N_E=e.O()}]);