(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{13673:()=>{},16516:(e,t,r)=>{"use strict";r.d(t,{CurrencyProvider:()=>a,H:()=>c});var n=r(95155),o=r(12115);let i=(0,o.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,o.useState)("INR");return(0,n.jsx)(i.Provider,{value:{currency:r,setCurrency:a},children:t})},c=()=>{let e=(0,o.useContext)(i);if(void 0===e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},38987:(e,t,r)=>{"use strict";r.d(t,{TransactionProvider:()=>s,x:()=>u});var n=r(95155),o=r(12115),i=r(96648),a=r(54901);let c=(0,o.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,o.useState)([]),[u,l]=(0,o.useState)(!0),{user:d}=(0,a.A)(),h=(0,o.useCallback)(async()=>{if(d){l(!0);try{let{data:e,error:t}=await i.N.from("transactions").select("id, account_id, description, amount, type, date, to_account_id").eq("user_id",d.id);if(t)throw t;let r=e.map(e=>({id:e.id,accountId:e.account_id,description:e.description,amount:e.amount,type:e.type,date:e.date||void 0,toAccountId:e.to_account_id}));s(r)}catch(e){console.error("Error fetching transactions:",e)}finally{l(!1)}}},[d]);(0,o.useEffect)(()=>{h()},[h]);let m=async e=>{if(d)if("transfer"===e.type&&e.toAccountId){let t={...e,type:"expense",user_id:d.id,account_id:e.accountId,to_account_id:e.toAccountId},r={...e,type:"income",user_id:d.id,account_id:e.toAccountId,to_account_id:e.accountId},{data:n,error:o}=await i.N.from("transactions").insert([t,r]).select();if(o)return void console.error("Error adding transfer transaction:",o);n&&await h()}else{let{data:t,error:r}=await i.N.from("transactions").insert([{...e,user_id:d.id,account_id:e.accountId}]).select().single();if(r)return void console.error("Error adding transaction:",r);t&&await h()}},f=async e=>{if(!d)return;let t=e.map(e=>({user_id:d.id,account_id:e.accountId,description:e.description,amount:e.amount,type:e.type,date:e.date,to_account_id:e.toAccountId}));try{let{error:e}=await i.N.from("transactions").insert(t);if(e)throw console.error("Error bulk adding transactions:",e),e;await h()}catch(e){throw console.error("Network error during bulk transaction insert:",e),e}};return(0,n.jsx)(c.Provider,{value:{transactions:r,addTransaction:m,bulkAddTransactions:f,isLoading:u},children:t})},u=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useTransactions must be used within a TransactionProvider");return e}},43849:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,13673,23)),Promise.resolve().then(r.bind(r,77296)),Promise.resolve().then(r.bind(r,54901)),Promise.resolve().then(r.bind(r,16516)),Promise.resolve().then(r.bind(r,38987))},54901:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,AuthProvider:()=>c});var n=r(95155),o=r(12115),i=r(96648);let a=(0,o.createContext)(void 0),c=e=>{let{children:t}=e,[r,c]=(0,o.useState)(null),[s,u]=(0,o.useState)(null),[l,d]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await i.N.auth.getSession();c(t),u(null!=(e=null==t?void 0:t.user)?e:null),d(!1)})();let{data:e}=i.N.auth.onAuthStateChange((e,t)=>{var r;c(t),u(null!=(r=null==t?void 0:t.user)?r:null),d(!1)});return()=>{null==e||e.subscription.unsubscribe()}},[]);let h=async()=>{await i.N.auth.signOut()};return(0,n.jsx)(a.Provider,{value:{session:r,user:s,isLoading:l,signOut:h},children:t})},s=()=>{let e=(0,o.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},77296:(e,t,r)=>{"use strict";r.d(t,{AccountProvider:()=>s,o:()=>u});var n=r(95155),o=r(12115),i=r(96648),a=r(54901);let c=(0,o.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,o.useState)([]),[u,l]=(0,o.useState)([]),[d,h]=(0,o.useState)(!0),{user:m}=(0,a.A)(),f=(0,o.useCallback)(async()=>{if(m){h(!0);try{let{data:e,error:t}=await i.N.from("accounts").select("id, name, color, opening_balance").eq("user_id",m.id);if(t)throw t;let r=e.map(e=>({id:e.id,name:e.name,color:e.color,opening_balance:e.opening_balance||0}));s(r),r.length>0&&0===u.length&&l([r[0].id])}catch(e){console.error("Error fetching accounts:",e)}finally{h(!1)}}},[m,u.length]);(0,o.useEffect)(()=>{f()},[f]);let p=async e=>{if(!m)return null;try{let{data:r,error:n}=await i.N.from("accounts").select("id, name, color, opening_balance").eq("user_id",m.id).eq("name",e.name.trim()).single();if(n&&"PGRST116"!==n.code){var t;if(console.error("Error checking for existing account:",n),(null==(t=n.message)||!t.includes("Failed to fetch"))&&""!==n.code)return null;console.warn("Network error during duplicate check, proceeding with account creation")}else if(r)return{id:r.id,name:r.name,color:r.color,opening_balance:r.opening_balance||0}}catch(e){console.warn("Network error during account lookup, proceeding with creation:",e)}let{data:r,error:n}=await i.N.from("accounts").insert([{name:e.name,color:e.color,opening_balance:e.opening_balance||0,user_id:m.id}]).select().single();if(n)return console.error("Error adding account:",n),null;if(r){let e={id:r.id,name:r.name,color:r.color,opening_balance:r.opening_balance||0};return s(t=>[...t,e]),l(t=>[...t,e.id]),e}return null},v=r.filter(e=>u.includes(e.id));return(0,n.jsx)(c.Provider,{value:{accounts:r,addAccount:p,selectedAccounts:v,setSelectedAccountIds:l,isLoading:d},children:t})},u=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAccounts must be used within an AccountProvider");return e}},96648:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});let n=(0,r(65040).UU)("https://nromeycartzmsproexuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yb21leWNhcnR6bXNwcm9leHVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NjA2ODMsImV4cCI6MjA3NDAzNjY4M30.cITyMLIOAmlkqXZIocWLHpKrO1BqbtwoHEqYcktRPUg")}},e=>{e.O(0,[978,40,441,255,358],()=>e(e.s=43849)),_N_E=e.O()}]);