(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{32383:()=>{},46428:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>z});var r=a(95155),n=a(12115),s=a(15239);let l={src:"/expense-tracker/_next/static/media/logo.16508e4c.png",height:1024,width:1024,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAATlBMVEX8896SmIrK0Lf17dfe2MKXsZRumHT/++j+9uGpq5w/jlUsdUHl5tDXyJe/toatvaHk3sq8va62kS+5pWWioEp/m35If0e9vaueo3C8u6oefVa3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAP0lEQVR4nBXBiRHAIAgAwUNRQPP/6b/RTHbB3YfEr5y1GNjc2zVlsNLbsY2GpVqfXR3eiJDV8VsiJMCzqurCB0bvAgGP6OpgAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8};var o=a(54901),d=a(77296),i=a(59455);let c=()=>{var e;let{user:t,signOut:a}=(0,o.A)(),{setSelectedAccountIds:l}=(0,d.o)(),c=(0,i._)(),[u,m]=(0,n.useState)(!1),[x,g]=(0,n.useState)(!1),[h,b]=(0,n.useState)(!1),[p,f]=(0,n.useState)(null),y=(0,n.useRef)(null);if((0,n.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),!t)return null;let v=null==(e=t.user_metadata)?void 0:e.avatar_url,k=t.email||"",j=async()=>{if(t){b(!0),f(null);try{let{error:e}=await c.from("transactions").delete().eq("user_id",t.id);if(e)throw e;let{error:a}=await c.from("accounts").delete().eq("user_id",t.id);if(a)throw a;l([]),g(!1),window.location.reload()}catch(e){console.error("Failed to clear data:",e),f(e instanceof Error?e.message:"Failed to clear data. Please try again.")}finally{b(!1)}}};return(0,r.jsxs)("div",{className:"relative",ref:y,children:[(0,r.jsx)("button",{onClick:()=>m(!u),className:"w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent",children:v?(0,r.jsx)(s.default,{src:v,alt:"User Avatar",width:40,height:40,className:"rounded-full"}):(0,r.jsx)("span",{className:"text-lg font-semibold",children:(e=>e?e.charAt(0).toUpperCase():"?")(k)})}),u&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-dark-secondary rounded-md shadow-lg py-1 z-50 ring-1 ring-black ring-opacity-5",children:[(0,r.jsxs)("div",{className:"px-4 py-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 dark:text-dark-text",children:"Signed in as"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:k})]}),(0,r.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-600"}),(0,r.jsx)("button",{onClick:()=>{m(!1),f(null),g(!0)},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/30",children:"Clear All Data"}),(0,r.jsx)("button",{onClick:a,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-dark-text hover:bg-gray-100 dark:hover:bg-dark-hover",children:"Logout"})]}),x&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 px-4",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-dark-secondary rounded-lg shadow-xl w-full max-w-sm p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete all data?"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-dark-subtle",children:"This will permanently remove every account and transaction from your workspace. This action cannot be undone."}),p&&(0,r.jsx)("p",{className:"mt-3 text-sm text-red-600",children:p}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{g(!1),f(null)},className:"px-4 py-2 rounded-md text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-dark-hover dark:text-dark-text",disabled:h,children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:j,className:"px-4 py-2 rounded-md text-sm font-medium bg-red-600 text-white hover:bg-red-700 disabled:opacity-50",disabled:h,children:h?"Clearing...":"Delete Everything"})]})]})})]})},u=()=>(0,r.jsx)("header",{className:"bg-emerald-500 text-white shadow-lg rounded-b-3xl",children:(0,r.jsxs)("div",{className:"px-4 py-4 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsx)(s.default,{src:l,alt:"Expense Tracker logo",width:48,height:48,className:"w-12 h-12 rounded-xl",priority:!0})}),(0,r.jsx)(c,{})]})}),m=e=>{let{onSuccess:t}=e,a=(0,i._)(),s=(0,i.I)(),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[h,b]=(0,n.useState)(!1),[p,f]=(0,n.useState)(""),y=async e=>{e.preventDefault(),b(!0),f("");try{if(l){if(u!==x)return void f("Passwords do not match");let{error:e}=await a.auth.signUp({email:d,password:u});if(e)throw e;f("Check your email for the confirmation link!")}else{let{error:e}=await a.auth.signInWithPassword({email:d,password:u});if(e)throw e;null==t||t()}}catch(e){f(e instanceof Error?e.message:"An unexpected error occurred")}finally{b(!1)}},v=async()=>{b(!0),f("");try{let{error:e}=await a.auth.signInWithOAuth({provider:"google",options:{queryParams:{prompt:"select_account"}}});if(e)throw e}catch(e){f(e instanceof Error?e.message:"An unexpected error occurred")}finally{b(!1)}},k=async e=>{c(e),e.includes("@")&&e.includes(".com")?f(""):f("Please enter valid email")};return(0,r.jsxs)("div",{className:"w-full max-w-md space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Expense Tracker"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:l?"Create your account":"Sign in to your account"})]}),p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:p}),(0,r.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email address"}),(0,r.jsx)("input",{id:"email",type:"email",required:!0,value:d,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter your email"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,r.jsx)("input",{id:"password",type:"password",required:!0,value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter your password"})]}),l&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,r.jsx)("input",{id:"confirmPassword",type:"password",required:!0,value:x,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Confirm your password"})]}),(0,r.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Loading...":l?"Sign up":"Sign in"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,r.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),(0,r.jsxs)("button",{onClick:v,disabled:h,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>o(!l),className:"text-sm text-emerald-600 hover:text-emerald-500 font-medium",children:l?"Already have an account? Sign in":"Don't have an account? Sign up"})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>s(),className:"text-xs text-gray-500 hover:text-emerald-600",children:"Configure Supabase connection"})})]})},x=e=>{let{children:t}=e,{session:a,isLoading:n}=(0,o.A)();return n?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):a?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gray-100 px-4 py-8",children:(0,r.jsx)("div",{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow-lg",children:(0,r.jsx)(m,{})})})},g=e=>{let{activeTab:t,onTabChange:a}=e,n=[{key:"dashboard",label:"Dashboard",icon:(0,r.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]})},{key:"reports",label:"Reports",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{key:"actions",label:"Actions",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}];return(0,r.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-dark-card border-t border-gray-200 dark:border-gray-800 z-50",children:(0,r.jsx)("div",{className:"flex justify-around items-center h-16 px-4 max-w-md mx-auto w-full",children:n.map(e=>(0,r.jsxs)("button",{onClick:()=>a(e.key),className:"flex flex-col items-center justify-center space-y-1 px-3 py-2 rounded-lg transition-colors duration-200 ".concat(t===e.key?"text-brand-accent bg-brand-accent/10":"text-gray-500 dark:text-dark-subtle hover:text-gray-700 dark:hover:text-dark-text"),"aria-label":e.label,children:[e.icon,(0,r.jsx)("span",{className:"text-xs font-medium",children:e.label})]},e.key))})})};var h=a(16516);let b=e=>{var t,a,s;let{transactions:l,initialAccountId:o}=e,{accounts:i}=(0,d.o)(),{currency:c}=(0,h.H)(),[u,m]=(0,n.useState)(null!=o?o:"all");(0,n.useEffect)(()=>{m(null!=o?o:"all")},[o]);let x="INR"===c?"₹":"$",g=new Map(i.map(e=>[e.id,e])),b=(0,n.useMemo)(()=>"all"===u?l:l.filter(e=>e.accountId===u),[l,u]),p=(0,n.useMemo)(()=>{let e=b.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),t=b.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0);return{income:e,expenses:t,balance:e-t}},[b]);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Filter by Account"}),(0,r.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-dark-card text-gray-900 dark:text-dark-text focus:ring-2 focus:ring-brand-accent focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"All Accounts"}),i.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"all"===u?"Overall Summary":"".concat(null==(t=g.get(u))?void 0:t.name," Summary")}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:"Income"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-income",children:["+",x,p.income.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:"Expenses"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-expense",children:["-",x,p.expenses.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:"Balance"}),(0,r.jsxs)("p",{className:"text-lg font-semibold ".concat(p.balance>=0?"text-income":"text-expense"),children:[p.balance>=0?"+":"",x,p.balance.toFixed(2)]})]})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:["Transactions ","all"!==u&&"- ".concat(null==(a=g.get(u))?void 0:a.name)]}),0===b.length?(0,r.jsx)("p",{className:"text-gray-500 dark:text-dark-subtle",children:"all"===u?"No transactions found.":"No transactions found for ".concat(null==(s=g.get(u))?void 0:s.name,".")}):(0,r.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:b.map(e=>{let t=g.get(e.accountId),a=e.description;if(e.description.startsWith("Transfer to")){let t=g.get(e.toAccountId||"");t&&(a="Transfer to ".concat(t.name))}else if(e.description.startsWith("Transfer from")){let t=b.find(t=>t.id===e.id.replace("-to",""));if(t){let e=g.get(t.accountId);e&&(a="Transfer from ".concat(e.name))}}return(0,r.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-dark-bg rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t&&(0,r.jsx)("span",{className:"w-2 h-8 rounded-full flex-shrink-0",style:{backgroundColor:t.color},title:t.name}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900 dark:text-dark-text truncate",children:a}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle",children:["all"===u&&(0,r.jsxs)("span",{className:"font-semibold",children:[null==t?void 0:t.name," | "]}),e.date?new Date(e.date).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""]})]})]}),(0,r.jsxs)("span",{className:"font-semibold text-lg whitespace-nowrap ml-2 ".concat("income"===e.type?"text-income":"text-expense"),children:["income"===e.type?"+":"-",x,e.amount.toFixed(2)]})]},e.id)})})]})]})};var p=a(70740);a(99157);var f=a(43569),y=a(96059),v=a(57218);let k=e=>{let{options:t,value:a,onChange:s,onCreateOption:l,placeholder:o="Select an option...",disabled:d=!1,loading:i=!1,clearable:c=!1,className:u="",id:m}=e,[x,g]=(0,n.useState)(!1),[h,b]=(0,n.useState)(""),[p,k]=(0,n.useState)(-1),j=(0,n.useRef)(null),w=(0,n.useRef)(null),N=t.filter(e=>e.label.toLowerCase().includes(h.toLowerCase())),C=l&&h.trim()&&!N.some(e=>e.label.toLowerCase()===h.toLowerCase());(0,n.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&(g(!1),b(""),k(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,n.useEffect)(()=>{let e=e=>{if(!x)return;let t=N.length+ +!!C;switch(e.key){case"ArrowDown":e.preventDefault(),k(e=>e<t-1?e+1:0);break;case"ArrowUp":e.preventDefault(),k(e=>e>0?e-1:t-1);break;case"Enter":e.preventDefault(),p>=0&&(p<N.length?S(N[p]):C&&A());break;case"Escape":g(!1),b(""),k(-1)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[x,p,N,C,h]);let S=e=>{s(e),g(!1),b(""),k(-1)},A=async()=>{if(l&&h.trim())try{let e=await l(h.trim());e&&s(e),g(!1),b(""),k(-1)}catch(e){console.error("Failed to create option:",e)}};return(0,r.jsxs)("div",{ref:j,className:"relative ".concat(u),children:[(0,r.jsx)("div",{className:"\n          w-full px-3 py-2 bg-brand-secondary dark:bg-dark-card \n          border border-gray-300 dark:border-gray-700 rounded-lg \n          shadow-sm cursor-pointer transition-colors\n          ".concat(x?"ring-2 ring-brand-accent border-brand-accent":"hover:border-brand-accent","\n          ").concat(d?"opacity-50 cursor-not-allowed":"","\n        "),onClick:()=>{d||i||(g(!x),x||setTimeout(()=>{var e;return null==(e=w.current)?void 0:e.focus()},0))},children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex-1 min-w-0",children:x?(0,r.jsx)("input",{ref:w,type:"text",value:h,onChange:e=>b(e.target.value),className:"w-full bg-transparent outline-none text-gray-900 dark:text-dark-text placeholder-gray-500 dark:placeholder-gray-400",placeholder:a?a.label:o,onClick:e=>e.stopPropagation(),id:m}):(0,r.jsx)("span",{className:"block truncate ".concat(a?"text-gray-900 dark:text-dark-text":"text-gray-500 dark:text-gray-400"),children:a?a.label:o})}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[c&&a&&!d&&(0,r.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),s(null)},className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:(0,r.jsx)(f.A,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})}),(0,r.jsx)(y.A,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 transition-transform ".concat(x?"rotate-180":"")})]})]})}),x&&(0,r.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-dark-card border border-gray-300 dark:border-gray-700 rounded-lg shadow-lg max-h-60 overflow-auto",children:i?(0,r.jsx)("div",{className:"px-3 py-2 text-gray-500 dark:text-gray-400",children:"Loading..."}):(0,r.jsx)(r.Fragment,{children:0!==N.length||C?(0,r.jsxs)(r.Fragment,{children:[N.map((e,t)=>(0,r.jsx)("div",{className:"\n                        px-3 py-2 cursor-pointer transition-colors\n                        ".concat(p===t?"bg-brand-accent text-white":"text-gray-900 dark:text-dark-text hover:bg-gray-100 dark:hover:bg-gray-700","\n                      "),onClick:()=>S(e),children:e.label},e.value)),C&&(0,r.jsxs)("div",{className:"\n                        px-3 py-2 cursor-pointer transition-colors flex items-center space-x-2\n                        ".concat(p===N.length?"bg-brand-accent text-white":"text-brand-accent hover:bg-gray-100 dark:hover:bg-gray-700","\n                      "),onClick:A,children:[(0,r.jsx)(v.A,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:['Create "',h,'"']})]})]}):(0,r.jsx)("div",{className:"px-3 py-2 text-gray-500 dark:text-gray-400",children:"No options found"})})})]})},j=/^-?(?:\d+|\d*\.\d{1,2})$/,w=e=>{let t=e.trim();if(!t)return{isValid:!1,error:"Opening balance is required"};if(!j.test(t))return{isValid:!1,error:"Use a valid number with up to 2 decimals"};let a=Number(t);return Number.isNaN(a)?{isValid:!1,error:"Enter a valid numeric value"}:{isValid:!0,value:Number(a.toFixed(2))}},N=e=>{if("number"==typeof e)return e.toFixed(2);let t=Number(e);return Number.isNaN(t)?e:t.toFixed(2)},C=e=>{let{onAddTransaction:t}=e,{accounts:a,selectedAccounts:s,addAccount:l}=(0,d.o)(),[o,i]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[m,x]=(0,n.useState)("expense"),[g,h]=(0,n.useState)(new Date),[b,f]=(0,n.useState)(null),[y,v]=(0,n.useState)(null),[j,C]=(0,n.useState)(!1),[S,A]=(0,n.useState)(!1),[E,L]=(0,n.useState)(null),[F,I]=(0,n.useState)("0.00"),[D,_]=(0,n.useState)(null),M=a.map(e=>({value:e.id,label:e.name}));(0,n.useEffect)(()=>{1===s.length?f({value:s[0].id,label:s[0].name}):f(null),v(null)},[s,a]);let T=e=>new Promise(t=>{I("0.00"),_(null),L({name:e,resolve:t})}),V=async()=>{if(!E)return;_(null);let e=w(F);if(!e.isValid||"number"!=typeof e.value)return void _(e.error||"Enter a valid opening balance");A(!0);try{let t=await l({name:E.name,color:"#CCCCCC",opening_balance:e.value}),a={value:t.id,label:t.name};E.resolve(a),L(null)}catch(e){_(e instanceof Error?e.message:"Failed to create account")}finally{A(!1)}},B=async e=>{e.preventDefault();let a=parseFloat(c);if(!o||!c||isNaN(a)||a<=0||!b)return void alert("Please fill all fields, including selecting or creating an account.");if("transfer"===m&&!y)return void alert("Please select or create a destination account for the transfer.");if("transfer"===m&&(null==b?void 0:b.value)===(null==y?void 0:y.value))return void alert("From and To accounts cannot be the same for a transfer.");C(!0);try{await t({accountId:b.value,description:o,amount:a,type:m,date:(g||new Date).toISOString(),..."transfer"===m&&{toAccountId:null==y?void 0:y.value}}),i(""),u(""),x("expense"),h(new Date),1!==s.length&&f(null),v(null)}catch(e){console.error("Failed to add transaction",e),alert("Failed to add transaction. Please try again.")}finally{C(!1)}};return(0,r.jsxs)("div",{className:"p-4 bg-white dark:bg-dark-bg shadow-md rounded-lg",children:[(0,r.jsx)("form",{onSubmit:B,className:"space-y-6",children:(0,r.jsxs)("fieldset",{disabled:j,className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-dark-text",children:"Add Transaction"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Account"}),(0,r.jsx)(k,{id:"account",options:M,value:b,onChange:f,onCreateOption:T,placeholder:"Select or create an account...",disabled:S||1===s.length&&!!b,loading:S,clearable:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Description"}),(0,r.jsx)("input",{type:"text",id:"description",value:o,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 bg-brand-secondary dark:bg-dark-bg border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-brand-accent text-gray-900 dark:text-dark-text disabled:opacity-50",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Amount"}),(0,r.jsx)("input",{type:"number",id:"amount",value:c,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 bg-brand-secondary dark:bg-dark-bg border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-brand-accent text-gray-900 dark:text-dark-text disabled:opacity-50",required:!0,step:"0.01"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Type"}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:["expense","income","transfer"].map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>x(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 ".concat(m===e?"bg-brand-accent text-white":"bg-brand-secondary dark:bg-dark-hover text-gray-700 dark:text-dark-text hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),"transfer"===m&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"To Account"}),(0,r.jsx)(k,{id:"toAccount",options:M.filter(e=>e.value!==(null==b?void 0:b.value)),value:y,onChange:v,onCreateOption:T,placeholder:"Select or create destination...",disabled:S,loading:S,clearable:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-1",children:"Date"}),(0,r.jsx)(p.Ay,{id:"date",selected:g,onChange:e=>h(e),className:"w-full px-3 py-2 bg-brand-secondary dark:bg-dark-bg border border-gray-300 dark:border-gray-700 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-brand-accent text-gray-900 dark:text-dark-text disabled:opacity-50"})]}),(0,r.jsx)("div",{className:"flex justify-end pt-2",children:(0,r.jsx)("button",{type:"submit",className:"w-full px-4 py-2 bg-brand-accent text-white font-semibold rounded-lg shadow-md hover:bg-brand-accent-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent disabled:opacity-50 transition-colors",children:j?"Adding...":"Add Transaction"})})]})}),E&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-dark-secondary rounded-lg shadow-xl w-full max-w-md p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-dark-text",children:"Opening Balance"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle mt-1",children:["Set the starting balance for ",(0,r.jsx)("span",{className:"font-medium",children:E.name}),"."]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:"pendingBalance",className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Opening Balance"}),(0,r.jsx)("input",{id:"pendingBalance",type:"text",inputMode:"decimal",value:F,onChange:e=>{I(e.target.value),_(null)},onBlur:()=>{let e=w(F);e.isValid&&"number"==typeof e.value&&I(N(e.value))},className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none sm:text-sm dark:bg-dark-hover dark:border-gray-600 dark:text-white ".concat(D?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"),placeholder:"0.00"}),D&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",children:D})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{E&&E.resolve(null),L(null),_(null)},className:"px-4 py-2 rounded-md text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-dark-hover dark:text-dark-text",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:V,className:"px-4 py-2 rounded-md text-sm font-medium bg-brand-accent text-white hover:bg-brand-accent-dark disabled:opacity-50",disabled:S,children:S?"Saving...":"Save"})]})]})})]})};var S=a(9349),A=a.n(S),E=a(4246);function L(e){if(null==e||e instanceof Date)return null;let t="number"==typeof e?e:parseFloat(String(e).replace(/[,\s]/g,""));return Number.isNaN(t)?null:t}function F(e){if(!e)return;if(e instanceof Date)return e;let t=String(e).trim(),a=t.match(/^(\d{4}-\d{2}-\d{2})\s(\d{2}:\d{2}:\d{2})$/);if(a){let e=new Date("".concat(a[1],"T").concat(a[2]));if(!isNaN(e.getTime()))return e}let r=new Date(t);if(!isNaN(r.getTime()))return r}function I(e,t){let a=(String(e||"")||"").toLowerCase().replace(/\s+/g,"");return"income"===a?"income":"expenses"===a||"expense"===a?"expense":null!=t?t>=0?"income":"expense":null}let D=e=>{let{transactions:t,onImport:a}=e,s=(0,n.useRef)(null),{accounts:l,selectedAccounts:o,addAccount:i}=(0,d.o)(),[c,u]=(0,n.useState)({warnings:[],info:[]}),m=async e=>{let t=[],r=[];try{var n;let s=function(e){if(!e||0===e.length)return[];let t=Array.from(new Set(Object.keys(e[0]||{}).map(e=>e.trim()))),a=new Map(t.map(e=>[e.toLowerCase(),e])),r=(e,t)=>e[a.get(t.toLowerCase())||t],n=e=>{for(let t of["opening_balance","opening balance","initial_balance","initial balance","starting_balance","starting balance"]){let a=L(r(e,t));if(null!=a)return Number(a.toFixed(2))}},s="generic";!function(e){let t=new Set(e.map(e=>e.toLowerCase()));return["account","category","currency","amount","type","note","date"].every(e=>t.has(e))}(t)?function(e){let t=new Set(e.map(e=>e.toLowerCase()));return t.has("description")&&t.has("amount")}(t)&&(s="generic"):s="report";let l=[];for(let t of e){var o,d,i,c;if(t)if("report"===s){let e=L(r(t,"amount")),a=I(r(t,"type"),e),s=String(null!=(o=r(t,"note"))?o:"").trim(),i=F(r(t,"date")),c=String(null!=(d=r(t,"account"))?d:"").trim(),u=n(t);if(!s&&null==e||null==e||null==a)continue;l.push({tx:{accountId:"",description:s||"Transaction",amount:Math.abs(e),type:a,date:i?i.toISOString():void 0},accountName:c||void 0,openingBalance:u})}else{let e=String(null!=(i=r(t,"description"))?i:"").trim(),a=L(r(t,"amount")),s=I(r(t,"type"),a),o=F(r(t,"date")),d=String(null!=(c=r(t,"account"))?c:"").trim(),u=n(t);if(!e&&null==a||null==a||null==s)continue;l.push({tx:{accountId:"",description:e,amount:Math.abs(a),type:s,date:o?o.toISOString():void 0},accountName:d||void 0,openingBalance:u})}}return l}(e);if(0===s.length)return t.push("No valid transactions found in the file."),u({warnings:t,info:r}),!1;let d=new Map(l.map(e=>[e.name.trim().toLowerCase(),e.id])),c=l.length>0?1===o.length?o[0].id:(null==(n=l[0])?void 0:n.id)||"":"",m=new Set,x=new Map;s.forEach(e=>{let{accountName:t,openingBalance:a}=e;if(t&&""!==t.trim()){let e=t.trim();if(m.add(e),"number"==typeof a){let t=e.toLowerCase();x.has(t)||x.set(t,Number(a.toFixed(2)))}}});let g=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4"],h=0;for(let e of m){let a=e.toLowerCase();if(!d.get(a)){let n=g[h%g.length];h+=1;let s=x.get(a);if("number"==typeof s)r.push("Using imported opening balance ".concat(N(s),' for "').concat(e,'".'));else{let a=0;{let n=window.prompt('Opening balance for "'.concat(e,'"? (use negative numbers for liabilities)'),"0.00");if(n&&n.trim()){let s=w(n);s.isValid&&"number"==typeof s.value?(a=s.value,r.push('Opening balance for "'.concat(e,'" set to ').concat(N(a)," via prompt."))):t.push('Invalid opening balance provided for "'.concat(e,'". Defaulted to 0.00.'))}else t.push('No opening balance provided for "'.concat(e,'". Defaulted to 0.00.'))}s=a}try{let l=await i({name:e,color:n,opening_balance:null!=s?s:0});l?(d.set(a,l.id),r.push('Created account "'.concat(e,'" with opening balance ').concat(N(null!=s?s:0),"."))):t.push('Failed to create account "'.concat(e,'". Transactions will fall back to the default account.'))}catch(a){console.error('Failed to create account "'.concat(e,'":'),a),t.push('Could not create account "'.concat(e,'". Transactions assigned to default account.'))}}}let b=s.map(e=>{let{tx:t,accountName:a}=e,r="";if(a&&""!==a.trim()){let e=a.trim().toLowerCase();r=d.get(e)||c}else l.length>0&&(r=c);return!r&&c&&(r=c),{...t,accountId:r||"",id:crypto.randomUUID()}});if(0===b.length)return t.push("No transactions were created from this file."),u({warnings:t,info:r}),!1;return a(b),u({warnings:t,info:r}),!0}catch(e){return console.error("Normalization failed:",e),t.push("Failed to normalize the file. Please check the format and try again."),u({warnings:t,info:r}),!1}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-dark-text",children:"Data Management"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-2",children:"Import Transactions"}),(0,r.jsxs)("button",{onClick:()=>{var e;return null==(e=s.current)?void 0:e.click()},className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-dashed border-gray-400 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-500 dark:text-dark-subtle hover:bg-gray-100 dark:hover:bg-dark-card focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent dark:focus:ring-offset-dark-bg transition-all",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4 4m0 0L8 8m4-4v12"})}),(0,r.jsx)("span",{children:"Click to upload a file"})]}),(0,r.jsx)("input",{type:"file",ref:s,onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let r=new FileReader;a.name.endsWith(".csv")?A().parse(a,{header:!0,skipEmptyLines:!0,complete:async e=>{if(!await m(e.data)){var t;console.debug("[Import][CSV] Headers:",null==(t=e.meta)?void 0:t.fields),alert("No valid transactions found in the CSV. Please check the headers and data.")}},error:e=>{console.error("Error parsing CSV:",e),alert("Failed to parse CSV file. Please check the format.")}}):a.name.endsWith(".xlsx")||a.name.endsWith(".xls")?(r.onload=async e=>{try{var t;let a=null==(t=e.target)?void 0:t.result,r=E.LF(a,{type:"array"}),n=r.SheetNames[0],s=r.Sheets[n],l=E.Wp.sheet_to_json(s,{header:1,raw:!1});if(console.debug("[Import] Rows(header=1) len=",l.length,"firstHeaderRow=",l[0]),l.length>=2){let e=l[0].map(e=>String(e||"").trim().toLowerCase()),t=l.slice(1).filter(e=>Array.isArray(e)).map(t=>{let a={};return e.forEach((e,r)=>{a[e]=t[r]}),a});console.debug("[Import] Objects len=",t.length,"sample=",t[0]),await m(t)||alert("No valid transactions found in the Excel file. Please check the headers and data.")}else throw Error("No data rows found in sheet")}catch(e){console.error("Error processing Excel file:",e),alert("Failed to process Excel file.")}},r.onerror=e=>{console.error("Error reading Excel file:",e),alert("Failed to read Excel file.")},r.readAsArrayBuffer(a)):alert("Unsupported file type. Please upload a CSV or Excel file."),s.current&&(s.current.value="")},className:"hidden",accept:".csv, .xlsx, .xls"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-dark-subtle mt-2",children:"Supported formats: CSV, XLSX, XLS."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-dark-subtle mb-2",children:"Export Transactions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,r.jsxs)("button",{onClick:()=>{let e=new Blob([A().unparse(t)],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(e);a.setAttribute("href",r),a.setAttribute("download","transactions.csv"),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},disabled:0===t.length,className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-900 dark:text-dark-text bg-brand-secondary dark:bg-dark-bg hover:bg-gray-200 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent dark:focus:ring-offset-dark-card disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0L8 8m4-4v12"})}),(0,r.jsx)("span",{children:"Export CSV"})]}),(0,r.jsxs)("button",{onClick:()=>{let e=E.Wp.json_to_sheet(t),a=E.Wp.book_new();E.Wp.book_append_sheet(a,e,"Transactions"),E._h(a,"transactions.xlsx")},disabled:0===t.length,className:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-900 dark:text-dark-text bg-brand-secondary dark:bg-dark-bg hover:bg-gray-200 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-accent dark:focus:ring-offset-dark-card disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0L8 8m4-4v12"})}),(0,r.jsx)("span",{children:"Export Excel"})]})]})]}),(c.info.length>0||c.warnings.length>0)&&(0,r.jsxs)("div",{className:"pt-4 space-y-3",children:[c.info.length>0&&(0,r.jsxs)("div",{className:"p-3 rounded-md bg-green-50 text-sm text-green-800 dark:bg-green-900/30 dark:text-green-200",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"Import info"}),(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:c.info.map((e,t)=>(0,r.jsx)("li",{children:e},"info-".concat(t)))})]}),c.warnings.length>0&&(0,r.jsxs)("div",{className:"p-3 rounded-md bg-yellow-50 text-sm text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-100",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"Import warnings"}),(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:c.warnings.map((e,t)=>(0,r.jsx)("li",{children:e},"warning-".concat(t)))})]})]})]})},_=e=>{let{onAddTransaction:t,transactions:a,onImport:n}=e,{accounts:s}=(0,d.o)();return(0,r.jsxs)("div",{className:"space-y-6",children:[s.length>0&&(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Add Transaction"}),(0,r.jsx)(C,{onAddTransaction:t})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-dark-text",children:"Import/Export"}),(0,r.jsx)(D,{transactions:a,onImport:n})]}),0===s.length&&(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"mx-auto w-16 h-16 bg-brand-accent/10 rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-brand-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-dark-text mb-2",children:"Create Your First Account"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-dark-subtle mb-4",children:"Start by creating an account to track your transactions. You can add multiple accounts for different purposes."}),(0,r.jsx)("p",{className:"text-sm text-gray-400 dark:text-dark-subtle",children:"Use the account switcher at the top to create and manage your accounts."})]})})]})},M=e=>{let{account:t,balance:a,onClick:n,isSelected:s=!1}=e,{currency:l}=(0,h.H)();return(0,r.jsx)("div",{onClick:n,className:"text-white p-4 rounded-2xl shadow-lg cursor-pointer transition-all duration-200 hover:scale-105 min-h-[100px] ".concat(s?"ring-2 ring-white ring-opacity-50":""),style:{backgroundColor:t.color},children:(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"text-xs font-medium opacity-90 mb-1",children:t.name}),(0,r.jsxs)("div",{className:"text-lg font-bold",children:["INR"===l?"₹":"$"," ",a.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})};var T=a(72999);let V=e=>{let{onClose:t}=e,{addAccount:a}=(0,d.o)(),[s,l]=(0,n.useState)(""),[o,i]=(0,n.useState)("0.00"),[c,u]=(0,n.useState)("#FF5733"),[m,x]=(0,n.useState)(!1),[g,h]=(0,n.useState)({}),b=async e=>{if(e.preventDefault(),m)return;x(!0);let r={};s.trim()||(r.name="Account name is required");let n=w(o);if(n.isValid||(r.opening_balance=n.error),Object.keys(r).length>0){h(r),x(!1);return}h({});try{var l;await a({name:s.trim(),opening_balance:null!=(l=n.value)?l:0,color:c}),t()}catch(e){h({form:e instanceof Error?e.message:"Failed to add account"})}finally{x(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-sm z-50 dark:bg-dark-secondary",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 dark:text-white",children:"Add New Account"}),(0,r.jsx)("form",{onSubmit:b,children:(0,r.jsxs)("fieldset",{disabled:m,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Account Name"}),(0,r.jsx)("input",{type:"text",id:"name",value:s,onChange:e=>{l(e.target.value),h(e=>({...e,name:void 0,form:void 0}))},className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-dark-hover dark:border-gray-600 dark:placeholder-gray-400 dark:text-white disabled:opacity-50 ".concat(g.name?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300"),required:!0}),g.name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"opening_balance",className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Opening Balance"}),(0,r.jsx)("input",{type:"text",id:"opening_balance",value:o,onChange:e=>{i(e.target.value),h(e=>({...e,opening_balance:void 0,form:void 0}))},onBlur:()=>{let e=w(o);e.isValid&&"number"==typeof e.value&&i(N(e.value))},inputMode:"decimal",className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-dark-hover dark:border-gray-600 dark:placeholder-gray-400 dark:text-white disabled:opacity-50 ".concat(g.opening_balance?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300"),placeholder:"0"}),g.opening_balance&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.opening_balance})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text mb-2",children:"Account Color"}),(0,r.jsx)(T.z0,{color:c,onChangeComplete:e=>{u(e.hex),h(e=>({...e,form:void 0}))}})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 dark:bg-dark-hover dark:text-dark-text disabled:opacity-50",disabled:m,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:m,children:m?"Adding...":"Add Account"})]}),g.form&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",children:g.form})]})})]})})},B=e=>{let{onClose:t}=e,{accounts:a,updateAccount:s}=(0,d.o)(),[l,o]=(0,n.useState)({}),[i,c]=(0,n.useState)({});(0,n.useEffect)(()=>{let e={};a.forEach(t=>{e[t.id]={name:t.name,color:t.color,opening_balance:N(t.opening_balance)}}),o(e)},[a]);let u=(e,t,a)=>{o(r=>({...r,[e]:{...r[e],[t]:a}})),c(t=>{var a,r;return{...t,[e]:{loading:null!=(r=null==(a=t[e])?void 0:a.loading)&&r,success:void 0,error:void 0}}})},m=async e=>{let t=l[e];if(!t)return;if(!t.name.trim())return void c(t=>({...t,[e]:{loading:!1,error:"Name cannot be empty"}}));let a=w(t.opening_balance);if(!a.isValid||"number"!=typeof a.value)return void c(t=>({...t,[e]:{loading:!1,error:a.error||"Invalid opening balance"}}));c(t=>({...t,[e]:{loading:!0}}));try{await s(e,{name:t.name.trim(),color:t.color||"#3b82f6",opening_balance:a.value}),c(t=>({...t,[e]:{loading:!1,success:"Saved"}}))}catch(a){let t=a instanceof Error?a.message:"Failed to update account";c(a=>({...a,[e]:{loading:!1,error:t}}))}};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-dark-secondary rounded-lg shadow-xl w-full max-w-2xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-dark-text",children:"Manage Accounts"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-dark-subtle mt-1",children:"Update names, colors, and opening balances. Changes apply immediately."})]}),(0,r.jsx)("button",{type:"button",onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-dark-subtle","aria-label":"Close manage accounts",children:"X"})]}),0===a.length?(0,r.jsx)("p",{className:"mt-6 text-sm text-gray-500 dark:text-dark-subtle",children:"No accounts yet. Create one to manage it here."}):(0,r.jsx)("div",{className:"mt-6 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:a.map(e=>{let t=l[e.id],a=i[e.id];return t?(0,r.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Account Name"}),(0,r.jsx)("input",{type:"text",value:t.name,onChange:t=>u(e.id,"name",t.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-brand-accent focus:border-brand-accent dark:bg-dark-hover dark:text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Color"}),(0,r.jsx)("input",{type:"color",value:t.color,onChange:t=>u(e.id,"color",t.target.value),className:"mt-1 w-full h-10 border border-gray-300 dark:border-gray-600 rounded-md"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text",children:"Opening Balance"}),(0,r.jsx)("input",{type:"text",inputMode:"decimal",value:t.opening_balance,onChange:t=>u(e.id,"opening_balance",t.target.value),onBlur:()=>(e=>{let t=l[e];if(!t)return;let a=w(t.opening_balance);a.isValid&&"number"==typeof a.value&&o(t=>({...t,[e]:{...t[e],opening_balance:N(a.value||0)}}))})(e.id),className:"mt-1 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-brand-accent focus:border-brand-accent dark:bg-dark-hover dark:text-white"})]})]}),(null==a?void 0:a.error)&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",children:a.error}),(null==a?void 0:a.success)&&(0,r.jsx)("p",{className:"mt-2 text-sm text-green-600",children:a.success}),(0,r.jsx)("div",{className:"mt-4 flex justify-end",children:(0,r.jsx)("button",{type:"button",onClick:()=>m(e.id),className:"px-4 py-2 rounded-md text-sm font-medium bg-brand-accent text-white hover:bg-brand-accent-dark disabled:opacity-50",disabled:null==a?void 0:a.loading,children:(null==a?void 0:a.loading)?"Saving...":"Save Changes"})})]},e.id):null})}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-md text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-dark-hover dark:text-dark-text",children:"Close"})})]})})},P=e=>{let{transactions:t,onAccountSelect:a,selectedAccountIds:s=[],onAddTransaction:l}=e,{accounts:o}=(0,d.o)(),{currency:i}=(0,h.H)(),c="INR"===i?"₹":"$",[u,m]=(0,n.useState)(!1),[x,g]=(0,n.useState)(!1),b=(0,n.useMemo)(()=>{let e=new Map;return o.forEach(t=>{e.set(t.id,t.opening_balance||0)}),t.forEach(t=>{let a=e.get(t.accountId)||0;"income"===t.type?e.set(t.accountId,a+t.amount):e.set(t.accountId,a-t.amount)}),e},[o,t]),p=(0,n.useMemo)(()=>{let e=new Date;e.setDate(e.getDate()-30);let a=t.filter(t=>"expense"===t.type&&t.date&&new Date(t.date)>=e),r=a.reduce((e,t)=>e+t.amount,0),n=new Map;return a.forEach(e=>{let t=e.description.split(" ")[0]||"Other";n.set(t,(n.get(t)||0)+e.amount)}),{total:r,categories:Array.from(n.entries()).map(e=>{let[t,a]=e;return{name:t,amount:a,percentage:r>0?a/r*100:0}})}},[t]),f=["#10b981","#ef4444","#f59e0b","#3b82f6","#8b5cf6"];return(0,r.jsxs)("div",{className:"space-y-6 pb-6 w-full px-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm w-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4 gap-3",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"List of accounts"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>g(!0),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Manage"}),(0,r.jsx)("button",{type:"button",onClick:()=>m(!0),className:"px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"+ Add"})]})]}),(0,r.jsx)("div",{className:"grid gap-4 grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",children:o.map(e=>(0,r.jsx)(M,{account:e,balance:b.get(e.id)||0,onClick:()=>null==a?void 0:a(e.id),isSelected:s.includes(e.id)},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm w-full",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Expense structure"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"LAST 30 DAYS"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900 mb-6",children:[c," ",p.total.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),p.total>0?(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsxs)("div",{className:"relative w-48 h-48",children:[(0,r.jsxs)("svg",{className:"w-48 h-48 transform -rotate-90",viewBox:"0 0 42 42",children:[(0,r.jsx)("circle",{cx:"21",cy:"21",r:"15.915",fill:"transparent",stroke:"#e5e7eb",strokeWidth:"3"}),p.categories.map((e,t)=>{let a=f[t%f.length],n=2*Math.PI*15.915,s=n-e.percentage/100*n,l=p.categories.slice(0,t).reduce((e,t)=>e+t.percentage,0);return(0,r.jsx)("circle",{cx:"21",cy:"21",r:"15.915",fill:"transparent",stroke:a,strokeWidth:"3",strokeDasharray:n,strokeDashoffset:s,strokeLinecap:"round",style:{transformOrigin:"21px 21px",transform:"rotate(".concat(l/100*360,"deg)")},className:"transition-all duration-300"},e.name)})]}),(0,r.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"All"}),(0,r.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:[c," ",p.total.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center h-48",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"No expenses in the last 30 days"})]})}),p.categories.length>0&&(0,r.jsx)("div",{className:"mt-4 space-y-2",children:p.categories.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:f[t%f.length]}}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:e.name})]}),(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[c,e.amount.toFixed(2)," (",e.percentage.toFixed(1),"%)"]})]},e.name))})]}),(0,r.jsx)("div",{className:"fixed bottom-20 right-4 z-40",children:(0,r.jsx)("button",{onClick:l,className:"bg-blue-500 hover:bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-110",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})}),u&&(0,r.jsx)(V,{onClose:()=>m(!1)}),x&&(0,r.jsx)(B,{onClose:()=>g(!1)})]})};var W=a(38987);function z(){let{accounts:e,selectedAccounts:t,setSelectedAccountIds:a}=(0,d.o)(),{transactions:s,addTransaction:l,bulkAddTransactions:o}=(0,W.x)(),[i,c]=(0,n.useState)("dashboard"),[m,h]=(0,n.useState)(void 0),p=async e=>{await l(e)},f=async e=>{try{let t=e.filter(e=>!e.accountId||""===e.accountId.trim());if(t.length>0){console.error("Some transactions have invalid account IDs:",t),alert("Some transactions could not be imported due to invalid account information.");return}let a=e.map(e=>{let{id:t,...a}=e;return a});await o(a),alert("Transactions imported successfully!")}catch(a){console.error("Import failed:",a);let e=a instanceof Error?a.message:"Unknown error occurred",t=a&&"object"==typeof a&&"code"in a?a.code:void 0;(null==e?void 0:e.includes("Failed to fetch"))||""===t?alert("Import failed due to network connectivity issues. Please check your internet connection and try again."):alert("Import failed: ".concat(e))}},y=(0,n.useMemo)(()=>{if(0===t.length)return[];let e=t.map(e=>e.id);return s.filter(t=>e.includes(t.accountId))},[s,t]),v=t=>{e.find(e=>e.id===t)&&(a([t]),h(t),c("reports"))},k=()=>{c("actions")};return(0,r.jsx)(x,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-dark-background text-gray-900 dark:text-dark-text",children:[(0,r.jsx)(u,{}),(0,r.jsx)("main",{className:"px-4 py-6",children:(0,r.jsx)("div",{className:"space-y-8 w-full pb-24",children:(()=>{switch(i){case"dashboard":return(0,r.jsx)(P,{transactions:s,onAccountSelect:v,selectedAccountIds:t.map(e=>e.id),onAddTransaction:k});case"reports":return(0,r.jsx)(b,{transactions:y,initialAccountId:m});case"actions":return(0,r.jsx)(_,{onAddTransaction:p,transactions:y,onImport:f});default:return null}})()})}),(0,r.jsx)(g,{activeTab:i,onTabChange:t=>{"reports"!==t?h(void 0):(h(void 0),a(e.map(e=>e.id))),c(t)}})]})})}},64710:(e,t,a)=>{Promise.resolve().then(a.bind(a,46428))},83686:()=>{}},e=>{e.O(0,[38,524,20,579,40,182,865,441,255,358],()=>e(e.s=64710)),_N_E=e.O()}]);