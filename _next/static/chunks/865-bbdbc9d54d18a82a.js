"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[865],{16516:(e,r,t)=>{t.d(r,{CurrencyProvider:()=>i,H:()=>s});var n=t(95155),a=t(12115);let o=(0,a.createContext)(void 0),i=e=>{let{children:r}=e,[t,i]=(0,a.useState)("INR");return(0,n.jsx)(o.Provider,{value:{currency:t,setCurrency:i},children:r})},s=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},38987:(e,r,t)=>{t.d(r,{TransactionProvider:()=>l,x:()=>c});var n=t(95155),a=t(12115),o=t(54901),i=t(59455);let s=(0,a.createContext)(void 0),l=e=>{let{children:r}=e,[t,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),{user:d}=(0,o.A)(),m=(0,i._)(),p=(0,a.useCallback)(async()=>{if(d){u(!0);try{let{data:e,error:r}=await m.from("transactions").select("id, account_id, description, amount, type, date, to_account_id").eq("user_id",d.id);if(r)throw r;let t=e.map(e=>({id:e.id,accountId:e.account_id,description:e.description,amount:e.amount,type:e.type,date:e.date||void 0,toAccountId:e.to_account_id}));l(t)}catch(e){console.error("Error fetching transactions:",e)}finally{u(!1)}}},[m,d]);(0,a.useEffect)(()=>{p()},[p]);let h=async e=>{if(d)if("transfer"===e.type&&e.toAccountId){let r={...e,type:"expense",user_id:d.id,account_id:e.accountId,to_account_id:e.toAccountId},t={...e,type:"income",user_id:d.id,account_id:e.toAccountId,to_account_id:e.accountId},{data:n,error:a}=await m.from("transactions").insert([r,t]).select();if(a)return void console.error("Error adding transfer transaction:",a);n&&await p()}else{let{data:r,error:t}=await m.from("transactions").insert([{...e,user_id:d.id,account_id:e.accountId}]).select().single();if(t)return void console.error("Error adding transaction:",t);r&&await p()}},f=async e=>{if(!d)return;let r=e.map(e=>({user_id:d.id,account_id:e.accountId,description:e.description,amount:e.amount,type:e.type,date:e.date,to_account_id:e.toAccountId}));try{let{error:e}=await m.from("transactions").insert(r);if(e)throw console.error("Error bulk adding transactions:",e),e;await p()}catch(e){throw console.error("Network error during bulk transaction insert:",e),e}};return(0,n.jsx)(s.Provider,{value:{transactions:t,addTransaction:h,bulkAddTransactions:f,isLoading:c},children:r})},c=()=>{let e=(0,a.useContext)(s);if(void 0===e)throw Error("useTransactions must be used within a TransactionProvider");return e}},54901:(e,r,t)=>{t.d(r,{A:()=>l,AuthProvider:()=>s});var n=t(95155),a=t(12115),o=t(59455);let i=(0,a.createContext)(void 0),s=e=>{let{children:r}=e,[t,s]=(0,a.useState)(null),[l,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0),m=(0,o._)();(0,a.useEffect)(()=>{(async()=>{var e;let{data:{session:r}}=await m.auth.getSession();s(r),c(null!=(e=null==r?void 0:r.user)?e:null),d(!1)})();let{data:e}=m.auth.onAuthStateChange((e,r)=>{var t;s(r),c(null!=(t=null==r?void 0:r.user)?t:null),d(!1)});return()=>{null==e||e.subscription.unsubscribe()}},[m]);let p=async()=>{await m.auth.signOut()};return(0,n.jsx)(i.Provider,{value:{session:t,user:l,isLoading:u,signOut:p},children:r})},l=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},59455:(e,r,t)=>{t.d(r,{SupabaseProvider:()=>p,_:()=>h,I:()=>f});var n=t(95155),a=t(12115);let o=e=>{let{initialUrl:r="",initialAnonKey:t="",isSaving:o=!1,error:i,onSubmit:s}=e,[l,c]=(0,a.useState)(r),[u,d]=(0,a.useState)(t);return(0,a.useEffect)(()=>{c(null!=r?r:"")},[r]),(0,a.useEffect)(()=>{d(null!=t?t:"")},[t]),(0,n.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-100 px-4 py-12",children:(0,n.jsxs)("div",{className:"w-full max-w-xl space-y-8 rounded-2xl bg-white p-10 shadow-xl",children:[(0,n.jsxs)("div",{className:"space-y-2 text-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Configure Supabase"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your Supabase project credentials to finish setting up the Expense Tracker."})]}),i&&(0,n.jsx)("div",{className:"rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:i}),(0,n.jsxs)("form",{className:"space-y-6",onSubmit:e=>{e.preventDefault(),s(l||"",u||"")},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"supabase-url",className:"block text-sm font-medium text-gray-700",children:"Supabase Project URL"}),(0,n.jsx)("input",{id:"supabase-url",type:"url",value:l||"",onChange:e=>c(e.target.value),placeholder:"https://your-project.supabase.co",className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"supabase-anon-key",className:"block text-sm font-medium text-gray-700",children:"Supabase Anon Key"}),(0,n.jsx)("textarea",{id:"supabase-anon-key",value:u||"",onChange:e=>d(e.target.value),placeholder:"Enter your anon key",className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500",rows:4,required:!0}),(0,n.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"You can find this in Supabase under Settings > API > Project API keys."})]}),(0,n.jsx)("button",{type:"submit",disabled:o,className:"w-full rounded-md bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60",children:o?"Saving...":"Start Expense Tracker"})]})]})})};var i=t(65040);let s=null,l=(e,r)=>s=(0,i.UU)(e,r),c="https://nromeycartzmsproexuh.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yb21leWNhcnR6bXNwcm9leHVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NjA2ODMsImV4cCI6MjA3NDAzNjY4M30.cITyMLIOAmlkqXZIocWLHpKrO1BqbtwoHEqYcktRPUg";c&&u&&l(c,u);let d="expense-tracker.supabase-config",m=(0,a.createContext)(void 0),p=e=>{let{children:r}=e,[t,i]=(0,a.useState)(()=>null!==s?(()=>{if(!s)throw Error("Supabase client has not been initialized.");return s})():null),[c,u]=(0,a.useState)(!0),[p,h]=(0,a.useState)(!1),[f,b]=(0,a.useState)(null),[g,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(t)return void u(!1);let e="https://nromeycartzmsproexuh.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5yb21leWNhcnR6bXNwcm9leHVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NjA2ODMsImV4cCI6MjA3NDAzNjY4M30.cITyMLIOAmlkqXZIocWLHpKrO1BqbtwoHEqYcktRPUg";if(e&&r)return void i(l(e,r));{let e=window.localStorage.getItem(d);if(e)try{let r=JSON.parse(e);if(r.url&&r.anonKey){i(l(r.url,r.anonKey)),y({url:r.url,anonKey:r.anonKey});return}if(r.url||r.anonKey){var n,a;y({url:null!=(n=r.url)?n:"",anonKey:null!=(a=r.anonKey)?a:""})}}catch(e){window.localStorage.removeItem(d)}}u(!1)},[t]);let w=(0,a.useCallback)((e,r)=>{let t=e.trim(),n=r.trim();if(!t||!n)return void b("Both Supabase URL and anon key are required.");if(!/^https?:\/\//i.test(t))return void b("Please enter a valid Supabase URL (must start with http or https).");h(!0),b(null);try{let e=l(t,n);window.localStorage.setItem(d,JSON.stringify({url:t,anonKey:n})),y({url:t,anonKey:n}),i(e)}catch(e){console.error("Failed to initialize Supabase client:",e),b(e instanceof Error?e.message:"Failed to initialize Supabase. Please try again.")}finally{h(!1)}},[]),x=(0,a.useCallback)(()=>{window.localStorage.removeItem(d),s=null,y(null),i(null),u(!1)},[]),v=(0,a.useMemo)(()=>{if(t)return{supabase:t,resetSupabaseConfig:x}},[t,x]);return c?(0,n.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-100 dark:bg-dark-background",children:(0,n.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-b-2 border-emerald-600"})}):t&&v?(0,n.jsx)(m.Provider,{value:v,children:r}):(0,n.jsx)(o,{initialUrl:null==g?void 0:g.url,initialAnonKey:null==g?void 0:g.anonKey,isSaving:p,error:f,onSubmit:w})},h=()=>{let e=(0,a.useContext)(m);if(!e)throw Error("useSupabase must be used within a SupabaseProvider");return e.supabase},f=()=>{let e=(0,a.useContext)(m);if(!e)throw Error("useSupabaseConfig must be used within a SupabaseProvider");return e.resetSupabaseConfig}},77296:(e,r,t)=>{t.d(r,{AccountProvider:()=>l,o:()=>c});var n=t(95155),a=t(12115),o=t(59455),i=t(54901);let s=(0,a.createContext)(void 0),l=e=>{let{children:r}=e,[t,l]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[d,m]=(0,a.useState)(!0),{user:p}=(0,i.A)(),h=(0,o._)(),f=(0,a.useCallback)(async()=>{if(p){m(!0);try{let{data:e,error:r}=await h.from("accounts").select("id, name, color, opening_balance").eq("user_id",p.id);if(r)throw r;let t=e.map(e=>({id:e.id,name:e.name,color:e.color,opening_balance:e.opening_balance||0}));l(t),t.length>0&&0===c.length&&u([t[0].id])}catch(e){console.error("Error fetching accounts:",e)}finally{m(!1)}}},[h,p,c.length]);(0,a.useEffect)(()=>{f()},[f]);let b=async e=>{var r,t;if(!p)throw Error("You need to be signed in to create an account.");try{let{data:t,error:n}=await h.from("accounts").select("id, name, color, opening_balance").eq("user_id",p.id).eq("name",e.name.trim()).single();if(n&&"PGRST116"!==n.code)if(console.error("Error checking for existing account:",n),(null==(r=n.message)?void 0:r.includes("Failed to fetch"))||""===n.code)console.warn("Network error during duplicate check, proceeding with account creation");else throw n;else if(t)return{id:t.id,name:t.name,color:t.color,opening_balance:t.opening_balance||0}}catch(e){console.warn("Network error during account lookup, proceeding with creation:",e)}let{data:n,error:a}=await h.from("accounts").insert([{name:e.name,color:e.color,opening_balance:null!=(t=e.opening_balance)?t:0,user_id:p.id}]).select().single();if(a)throw console.error("Error adding account:",a),a;if(n){let e={id:n.id,name:n.name,color:n.color,opening_balance:n.opening_balance||0};return l(r=>[...r,e]),u(r=>[...r,e.id]),e}throw Error("Unable to create account. Please try again.")},g=async(e,r)=>{var n;if(!p)throw Error("You need to be signed in to update an account.");let a=t.find(r=>r.id===e);if(!a)throw Error("Account not found.");let o={...a,...r};l(r=>r.map(r=>r.id===e?o:r));let{data:i,error:s}=await h.from("accounts").update({name:r.name,color:r.color,opening_balance:null!=(n=r.opening_balance)?n:0}).eq("id",e).eq("user_id",p.id).select("id, name, color, opening_balance").single();if(s)throw console.error("Error updating account:",s),l(r=>r.map(r=>r.id===e?a:r)),s;if(!i)throw l(r=>r.map(r=>r.id===e?a:r)),Error("No updated account returned.");let c={id:i.id,name:i.name,color:i.color,opening_balance:i.opening_balance||0};return l(r=>r.map(r=>r.id===e?c:r)),c},y=t.filter(e=>c.includes(e.id));return(0,n.jsx)(s.Provider,{value:{accounts:t,addAccount:b,updateAccount:g,selectedAccounts:y,setSelectedAccountIds:u,isLoading:d},children:r})},c=()=>{let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAccounts must be used within an AccountProvider");return e}}}]);